{"title":"Docker 卷","uid":"a96f355e941f50f70bc1a882e3391dcd","slug":"docker/docker4","date":"2023-02-15T05:54:41.000Z","updated":"2023-02-15T08:30:07.604Z","comments":true,"path":"api/articles/docker/docker4.json","keywords":null,"cover":"/img/docker/docker-cover.png","content":"<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>《Docker 进阶与实战》</p></blockquote>\n<ul>\n<li>卷就是目录或者文件，由Docker daemon挂载到容器中，因此不属于联合文件系统，卷中的数据在容器被删除后仍然可以访问。Docker提供了两种管理数据的方式: 数据卷和数据卷容器。</li>\n</ul>\n<h2 id=\"主机目录挂载到容器目录\"><a href=\"#主机目录挂载到容器目录\" class=\"headerlink\" title=\"主机目录挂载到容器目录\"></a>主机目录挂载到容器目录</h2><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># -v 宿主机:容器  将宿主机的当前目录，挂载到容器的&#x2F;home&#x2F;qidai&#x2F;sync目录，且为只读模式\nqidai@qidai:~$ docker run -it -d -v .:&#x2F;home&#x2F;qidai&#x2F;sync:ro ubuntuip bash\nd93cfa701d57e6637e6225d334ccba4f8af4272d344f96bc0beaeb3b8fe17227\nqidai@qidai:~$ docker ps\nCONTAINER ID   IMAGE      COMMAND   CREATED          STATUS          PORTS     NAMES\nd93cfa701d57   ubuntuip   &quot;bash&quot;    3 seconds ago    Up 2 seconds              compassionate_shirley\nqidai@qidai:~$ ls\nDockerfile\nqidai@qidai:~$ docker exec -it compassionate_shirley bash \nroot@d93cfa701d57:&#x2F;# ls &#x2F;home&#x2F;qidai&#x2F;sync&#x2F;\nDockerfile\nroot@d93cfa701d57:&#x2F;# echo &quot;xx&quot; &gt;&gt; &#x2F;home&#x2F;qidai&#x2F;sync&#x2F;Dockerfile \nbash: &#x2F;home&#x2F;qidai&#x2F;sync&#x2F;Dockerfile: Read-only file system\nroot@d93cfa701d57:&#x2F;# </code></pre>\n\n<h2 id=\"数据卷容器\"><a href=\"#数据卷容器\" class=\"headerlink\" title=\"数据卷容器\"></a>数据卷容器</h2><ul>\n<li>可以用于多容器之间的数据共享。</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">qidai@qidai:~$ ls\nDockerfile\n# 一个不需要运行的容器用来数据同步\nqidai@qidai:~$ docker create --name dbsynv_container -v .:&#x2F;home&#x2F;qidai&#x2F;dbsync -it ubuntu\nc67e4262ad6b947bd25b4dc2636987fc92db489bafc0232b40785f8b9b0d9f81\n# --volumes-from 指定共享卷容器\nqidai@qidai:~$ docker run --name db1 -it  -d --volumes-from dbsynv_container ubuntu bash\n332fd2aeabd628f09b354dc3bf339778a631c8df51605860d6a13c3b7e75512a\n# --volumes-from 指定共享卷容器\nqidai@qidai:~$ docker run --name db2 -it  -d --volumes-from dbsynv_container ubuntu bash\nbdb837d3633756a73a43e625cb85901394e66a4408dada2771ea18315b1a219e\nqidai@qidai:~$ docker ps\nCONTAINER ID   IMAGE     COMMAND   CREATED              STATUS              PORTS     NAMES\nbdb837d36337   ubuntu    &quot;bash&quot;    4 seconds ago        Up 3 seconds                  db2\n332fd2aeabd6   ubuntu    &quot;bash&quot;    About a minute ago   Up About a minute             db1\nqidai@qidai:~$ docker exec db2 ls &#x2F;home&#x2F;qidai&#x2F;dbsync\nDockerfile\nqidai@qidai:~$ docker exec db1 ls &#x2F;home&#x2F;qidai&#x2F;dbsync\nDockerfile\nqidai@qidai:~$ ls\nDockerfile\nqidai@qidai:~$ touch c.py\nqidai@qidai:~$ docker exec db1 ls &#x2F;home&#x2F;qidai&#x2F;dbsync\nDockerfile\nc.py</code></pre>\n\n<h1 id=\"docker-volume\"><a href=\"#docker-volume\" class=\"headerlink\" title=\"docker volume\"></a>docker volume</h1><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">qidai@qidai:~$ docker volume \nUsage:  docker volume COMMAND\nManage volumes\nCommands:\n  create      Create a volume\n  inspect     Display detailed information on one or more volumes\n  ls          List volumes\n  prune       Remove all unused local volumes\n  rm          Remove one or more volumes</code></pre>\n\n<ul>\n<li>对于卷的插件开发等内容，可以参考《Docker 进阶与实战》</li>\n</ul>\n","feature":true,"abstracts":"Docker 卷知识","text":"Docker 卷知识","link":"","photos":[],"count_time":{"symbolsCount":"2.5k","symbolsTime":"2 mins."},"categories":[{"name":"Docker","slug":"Docker","count":4,"path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","slug":"Docker","count":4,"path":"api/tags/Docker.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%BB%E6%9C%BA%E7%9B%AE%E5%BD%95%E6%8C%82%E8%BD%BD%E5%88%B0%E5%AE%B9%E5%99%A8%E7%9B%AE%E5%BD%95\"><span class=\"toc-text\">主机目录挂载到容器目录</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8\"><span class=\"toc-text\">数据卷容器</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#docker-volume\"><span class=\"toc-text\">docker volume</span></a>","author":{"name":"Qidai","slug":"blog-author","avatar":"/img/v2-b98d05a15e22949b1a1c70d453fb71ed_720w.jpg","link":"/","description":"吃喝，死宅，折腾","socials":{"github":"https://github.com/ziqiang-wang-chn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/291152218"},"mail":{"icon":"/svg/mail.svg","link":"mailto:ziqiang_wang_chn@163.com"},"rss":{"icon":"/svg/RSS.svg","link":"https://ohbug.cn/atom.xml"}}}},"mapped":true,"prev_post":{},"next_post":{"title":"Docker 网络","uid":"ee6d2c39692a2e32a317cb32fe1cabc5","slug":"docker/docker3","date":"2023-02-14T12:55:41.000Z","updated":"2023-02-15T05:41:16.392Z","comments":true,"path":"api/articles/docker/docker3.json","keywords":null,"cover":"/img/docker/docker-cover.png","text":"Docker 网络知识","link":"","photos":[],"count_time":{"symbolsCount":"4k","symbolsTime":"4 mins."},"categories":[{"name":"Docker","slug":"Docker","count":4,"path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","slug":"Docker","count":4,"path":"api/tags/Docker.json"}],"author":{"name":"Qidai","slug":"blog-author","avatar":"/img/v2-b98d05a15e22949b1a1c70d453fb71ed_720w.jpg","link":"/","description":"吃喝，死宅，折腾","socials":{"github":"https://github.com/ziqiang-wang-chn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/291152218"},"mail":{"icon":"/svg/mail.svg","link":"mailto:ziqiang_wang_chn@163.com"},"rss":{"icon":"/svg/RSS.svg","link":"https://ohbug.cn/atom.xml"}}}},"feature":true}}