{"title":"Dockerfile","uid":"75603112ad785d198fb30f0b34b1d632","slug":"docker/docker2","date":"2023-02-13T14:27:41.000Z","updated":"2023-02-13T14:27:31.298Z","comments":true,"path":"api/articles/docker/docker2.json","keywords":null,"cover":"/img/docker/docker-cover.png","content":"<h1 id=\"Dockerfile\"><a href=\"#Dockerfile\" class=\"headerlink\" title=\"Dockerfile\"></a>Dockerfile</h1><ul>\n<li>Dockerfile中命令不区分大小写，但是大写是约定，更容易区分。格式为 <code>命令 参数...</code>。命令顺序执行，必须以FROM 开头.</li>\n<li><code>FROM</code> : 若使用多个镜像，则需要使用多个<code>FROM</code>。意思就是之后的构建命令基于哪个镜像进行构建。<code>FROM</code>前面只能有一个或多个<code>ARG</code>指令，这些指令声明Dockerfile中<code>FROM</code>行中使用的参数。多个 FROM 会产生多个 images，但是只有最后一个image有id值，其余的image只作为中间构建过程并无 id。</li>\n<li>MAINTAINER：作者信息。</li>\n<li>LABELS：其他信息。</li>\n<li>RUN：RUN指令创建的中间镜像会被缓存，并会在下次构建中使用。如果不想使用这些缓存镜像，可以在构建时指定<code>--no-cache</code>参数，如：<code>docker build --no-cache</code>。尽量将指令放入一个RUN中进行，因为RUN一次就多一层。最多126层。</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># &#x2F;bin&#x2F;sh -c来执行，直接可以使用Linux中的命令\nRUN &lt;command&gt;\n# 可以执行基础镜像中任意二进制程序，用exec执行：例如 RUN [&quot;&#x2F;bin&#x2F;bash&quot;, &quot;-c&quot;, &quot;echo xx&quot;]\nRUN [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]\n\n# 输出环境变量。而 [&quot;echo&quot;, &quot;$HOME&quot;]是获取不到的。\nRUN [&quot;sh&quot;, &quot;-c&quot;, &quot;echo&quot;, &quot;$HOME&quot;]</code></pre>\n\n<ul>\n<li>CMD：每个Dockerfile都只能有一个CMD指令 ，在启动容器时执行，若用户指定了运行的命令，则CMD被覆盖失效。CMD不同于RUN，CMD用于指定在容器启动时所要执行的命令，而RUN用于指定镜像构建时所要执行的命令。</li>\n</ul>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"># exec 格式\nCMD [&quot;executable&quot;,&quot;param1&quot;,&quot;param2&quot;]\n# 则直接调用ENTRYPOINT添加参数\nCMD [&quot;param1&quot;,&quot;param2&quot;] \n# &#x2F;bin&#x2F;sh 提供给需要交互的应用，shell内部命令\nCMD command param1 param2</code></pre>\n\n<ul>\n<li>ENTRYPOINT：ENTRYPOINT与CMD非常类似，不同的是通过docker run执行的命令不会覆盖ENTRYPOINT，<br>  而docker run命令中指定的任何参数，都会被当做参数再次传递给ENTRYPOINT。<br>  Dockerfile中只允许有一个ENTRYPOINT命令</li>\n</ul>\n","feature":true,"abstracts":"Dockerfile知识总结","text":"Dockerfile知识总结","link":"","photos":[],"count_time":{"symbolsCount":"1.2k","symbolsTime":"1 mins."},"categories":[{"name":"Docker","slug":"Docker","count":2,"path":"api/categories/Docker.json"}],"tags":[{"name":"Docker","slug":"Docker","count":2,"path":"api/tags/Docker.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Dockerfile\"><span class=\"toc-text\">Dockerfile</span></a></li></ol>","author":{"name":"Qidai","slug":"blog-author","avatar":"/img/v2-b98d05a15e22949b1a1c70d453fb71ed_720w.jpg","link":"/","description":"吃喝，死宅，折腾","socials":{"github":"https://github.com/ziqiang-wang-chn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/291152218"},"mail":{"icon":"/svg/mail.svg","link":"mailto:ziqiang_wang_chn@163.com"},"rss":{"icon":"/svg/RSS.svg","link":"https://ohbug.cn/atom.xml"}}}},"mapped":true,"prev_post":{},"next_post":{"title":"MySQL - 索引","uid":"db4d44c0ea1308c9e8989aac4272f703","slug":"mysql/mysql1","date":"2023-02-08T14:58:37.000Z","updated":"2023-02-08T15:25:54.069Z","comments":true,"path":"api/articles/mysql/mysql1.json","keywords":null,"cover":"/img/mysql/mysqlmust.jpg","text":"参考极客时间课程《MySQL实战45讲》","link":"","photos":[],"count_time":{"symbolsCount":"1.1k","symbolsTime":"1 mins."},"categories":[{"name":"MySQL","slug":"MySQL","count":1,"path":"api/categories/MySQL.json"}],"tags":[{"name":"MySQL","slug":"MySQL","count":2,"path":"api/tags/MySQL.json"}],"author":{"name":"Qidai","slug":"blog-author","avatar":"/img/v2-b98d05a15e22949b1a1c70d453fb71ed_720w.jpg","link":"/","description":"吃喝，死宅，折腾","socials":{"github":"https://github.com/ziqiang-wang-chn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/291152218"},"mail":{"icon":"/svg/mail.svg","link":"mailto:ziqiang_wang_chn@163.com"},"rss":{"icon":"/svg/RSS.svg","link":"https://ohbug.cn/atom.xml"}}}},"feature":true}}