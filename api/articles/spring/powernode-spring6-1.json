{"title":"Spring6 视频学习笔记","uid":"adc2bfcc2ad0706d0cd90ba63505fb2d","slug":"spring/powernode-spring6-1","date":"2023-01-12T00:51:17.000Z","updated":"2023-02-02T16:17:08.310Z","comments":true,"path":"api/articles/spring/powernode-spring6-1.json","keywords":null,"cover":"/img/spring/OG-Spring.png","content":"<div class=\"custom-quote tip\">\n<span class=\"custom-quote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M20.86 14.13C20 14.7 19.56 15.74 19.77 16.76C20.13 18.55 18.55 20.13 16.76 19.77C15.74 19.57 14.7 20 14.13 20.86C13.12 22.38 10.89 22.38 9.88 20.86C9.3 20 8.26 19.56 7.24 19.77C5.45 20.13 3.87 18.55 4.23 16.76C4.43 15.74 4 14.7 3.14 14.13C1.62 13.12 1.62 10.89 3.14 9.88C4 9.3 4.44 8.26 4.23 7.24C3.87 5.45 5.45 3.87 7.24 4.23C8.26 4.44 9.3 4 9.87 3.14C10.88 1.62 13.11 1.62 14.12 3.14C14.7 4 15.74 4.44 16.76 4.23C18.55 3.87 20.13 5.45 19.77 7.24C19.56 8.26 20 9.3 20.86 9.87C22.38 10.88 22.38 13.12 20.86 14.13Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M12.01 15C12.01 14.5 12.01 14.5 12.01 14.5C12.04 13.75 13 13.46 14.04 12.2C14.41 11.74 14.69 11.41 14.86 10.85C15.15 9.95 14.92 9.18 14.86 9.02C14.8 8.79 14.52 8 13.72 7.46C13.06 7.02 12.42 7 12.14 7C11.9 7 11.36 7 10.78 7.3C10.28 7.56 9.98 7.9 9.83 8.1C9.24 8.82 9.06 9.63 9 10.06\"></path>\n<path stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M11.99 18H12.01\"></path>\n</svg></span>\n<p class=\"custom-quote-title\">内容来源</p>\n<p>基于Oracle openJDK 17 ， Spring6\n</div>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>个人学习习惯，视频入门，书本精进。内容来自于视频讲解内容以及个人总结理解。</p></blockquote>\n<h1 id=\"OCP开闭原则\"><a href=\"#OCP开闭原则\" class=\"headerlink\" title=\"OCP开闭原则\"></a>OCP开闭原则</h1><ul>\n<li>在使用Spring中，Service层可能由如下实现，这样就规定死了<code>userDao</code>的真实类型的<code>UserDaoMysqlImpl</code>，在之后的系统升级维护中，若更改为其他的数据库，则必须手动更改Imple实现类。那么这样就会造成对项目源码的更改，这样的违背OCP开闭原则的。这个原则意思是<strong>对扩展开放，对修改关闭</strong>，即在维护升级中可以新建类等操作，但是不允许进行修改源代码。</li>\n<li>下面的代码也使得Service层的实现完全依赖与底层Impl的实现。这样的更改下层而牵动上层的设计，违背了<strong>DIP依赖倒置</strong>原则。</li>\n</ul>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">UserDao  userDao &#x3D; new UserDaoMysqlImple();</code></pre>\n\n<h1 id=\"DIP依赖倒置\"><a href=\"#DIP依赖倒置\" class=\"headerlink\" title=\"DIP依赖倒置\"></a>DIP依赖倒置</h1><ul>\n<li>DIP主要倡导面向抽象编程，面向接口编程，不要面向具体编程，让上层不再依赖下层，下面改动了，上面的代码不会受到牵连，目的是解耦，增加内聚。</li>\n<li>上面的代码段是面向具体编程了，在代码编写的时候就直接规定死了UserDao的实现类，Spring中的IoC就是来解决这个问题的。</li>\n</ul>\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">&#x2F;*与上面代码不同的是，这段代码若结合Spring使用，userDao的对象完全由Spring来注入，userDao的实现完全由配置决定，\n则面向接口编程意思就是我们只需要关注接口中的方法即可，而无需考虑实现类的具体实现。*&#x2F;\nUserDao  userDao;\npublic User findById(id) &#123;\n  return userDao.findById(Id);\n&#125;\n</code></pre>\n\n\n<h1 id=\"两个问题\"><a href=\"#两个问题\" class=\"headerlink\" title=\"两个问题\"></a>两个问题</h1><ul>\n<li>不让面向具体编程，不让自己<code>new</code>对象出来，那么怎么创建对象？<ul>\n<li><code>Spring</code>通过创建<code>Bean</code>的方式，通过用户配置，来创建需要的对象<code>Bean</code>。通过这样的方式，若以后项目升级维护，更改操作，则通过更改配置文件即可，而不用更改源码，解决掉了之前的OCP问题。</li>\n</ul>\n</li>\n<li>当类初始化后，不让<code>new</code>对象赋值，则<code>userDao</code>对象被使用会发生空指针怎么办？<ul>\n<li>同样是交由<code>Spring</code>进行管理，一样是通过配置文件的方法告诉<code>Spring</code>，<code>userDao</code>该如何赋值。这样通过面向接口编程，则有效解决了DIP问题。</li>\n</ul>\n</li>\n</ul>\n<h1 id=\"控制反转IoC\"><a href=\"#控制反转IoC\" class=\"headerlink\" title=\"控制反转IoC\"></a>控制反转IoC</h1><ul>\n<li>这是上面的总结下来的思想，之前我们的对象都是主动在程序中new创建出来的，而现在我们反过来，将对象的创建和对象间的管理权限全部交由Spring来管理维护，再由Spring将对象注入到配置好的位置。这样反过来的操作可以理解为IoC。</li>\n<li>IoC算是一种思想方法，而在Spring的实现中是通过配置好后，Spring进行依赖注入，依赖注入又称<strong>DI</strong>，DI的实现方式主要有<ul>\n<li>构造注入</li>\n<li>setter注入</li>\n</ul>\n</li>\n<li>结合之前学习的Java基础，则两种注入方法存在本质的不同，构造方法是在对象初始化，当对象的变量都分配好空间和默认值之后，构造方法开始对变量的内容进行初始化。而setter注入是在初始化完毕后，对象已经创建完毕后，setter注入才可以开始工作，两种方式初始化的时机是不一样的。</li>\n</ul>\n<h1 id=\"Spring结构\"><a href=\"#Spring结构\" class=\"headerlink\" title=\"Spring结构\"></a>Spring结构</h1><p><img src=\"/img/spring/powernode-spring6/spring-structure.png\"></p>\n<ol>\n<li>Spring Core：提供依赖注入特征来实现容器对Bean的管理。Spring应用的核心。</li>\n<li>Spring Context模块：国际化消息、事件传播、验证的支持，电子邮件、JNDI访问、EJB集成、远程以及时序调度服务。</li>\n<li>Spring AOP模块：自定义拦截器、切点、日志等操作。</li>\n<li>Spring DAO模块：用于简化JDBC。</li>\n<li>Spring ORM模块：ORM框架集成。</li>\n<li>Spring Web MVC模块：Spring为构建Web应用提供了一个功能全面的MVC框架。也可与其他MVC框架集成。</li>\n<li>Spring WebFlux模块：它是完全非阻塞的，支持反应式流(Reactive Stream)背压，并在Netty，Undertow等服务器上运行。</li>\n<li>Spring Web模块：提供了Spring和其它Web框架的集成。</li>\n</ol>\n<h1 id=\"案例程序：setter注入\"><a href=\"#案例程序：setter注入\" class=\"headerlink\" title=\"案例程序：setter注入\"></a>案例程序：setter注入</h1><details class=\"custom-details\">\n<summary>pom.xml</summary>\n<p><pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">&lt;dependencies&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework&lt;&#x2F;groupId&gt;\n        &lt;artifactId&gt;spring-context&lt;&#x2F;artifactId&gt;\n        &lt;version&gt;6.0.3&lt;&#x2F;version&gt;\n    &lt;&#x2F;dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;junit&lt;&#x2F;groupId&gt;\n        &lt;artifactId&gt;junit&lt;&#x2F;artifactId&gt;\n        &lt;version&gt;4.13.2&lt;&#x2F;version&gt;\n        &lt;scope&gt;test&lt;&#x2F;scope&gt;\n    &lt;&#x2F;dependency&gt;\n&lt;&#x2F;dependencies&gt;</code></pre>\n</p>\n</details>\n<br/>\n\n<pre class=\"line-numbers language-java\" data-language=\"java\"><code class=\"language-java\">&#x2F;&#x2F;Java程序\npublic class User &#123;\n    public User(String name, int id) &#123;\n        this.name &#x3D; name;\n        this.id &#x3D; id;\n        System.out.println(&quot;User(name,id) constructor init...&quot;);\n    &#125;\n    public User() &#123;\n        System.out.println(&quot;User() constructor init...&quot;);\n    &#125;\n    @Override\n    public String toString() &#123;\n        return &quot;User&#123;&quot; +\n                &quot;name&#x3D;&#39;&quot; + name + &#39;\\&#39;&#39; +\n                &quot;, id&#x3D;&quot; + id +\n                &#39;&#125;&#39;;\n    &#125;\n    private String name;\n    private int id;\n&#125;\n\npublic class UserService &#123;\n    public UserService() &#123;\n        System.out.println(&quot;UserService() constructor init...&quot;);\n    &#125;\n    private UserDao userDao;\n    public void setUserDao(UserDao userDao) &#123;\n        this.userDao &#x3D; userDao;\n    &#125;\n    public User getUserById(int i) &#123;\n        return userDao.getUserById(i);\n    &#125;\n&#125;\npublic class UserDao &#123;\n    public UserDao() &#123;\n        System.out.println(&quot;UserDao() constructor init...&quot;);\n    &#125;\n    public User getUserById(int i) &#123;\n        return new User(&quot;Qidai&quot;,i);\n    &#125;\n&#125;\n&#x2F;&#x2F;use\n@Test\npublic void test() &#123;\n    ApplicationContext context &#x3D; new ClassPathXmlApplicationContext(&quot;spring-config.xml&quot;);\n    UserService service &#x3D; context.getBean(&quot;userService&quot;, UserService.class);\n    User user &#x3D; service.getUserById(1);\n    System.out.println(user);\n\n&#125;\n&#x2F;&#x2F;out\nUserDao() constructor init...\nUserService() constructor init...\nUser(name,id) constructor init...\nUser&#123;name&#x3D;&#39;Qidai&#39;, id&#x3D;1&#125;</code></pre>\n\n<ul>\n<li>下面是Spring配置文件</li>\n</ul>\n<pre class=\"line-numbers language-markup\" data-language=\"markup\"><code class=\"language-markup\">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;\n&lt;beans xmlns&#x3D;&quot;http:&#x2F;&#x2F;www.springframework.org&#x2F;schema&#x2F;beans&quot;\n       xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;\n       xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;www.springframework.org&#x2F;schema&#x2F;beans http:&#x2F;&#x2F;www.springframework.org&#x2F;schema&#x2F;beans&#x2F;spring-beans.xsd&quot;&gt;\n\n        &lt;bean id&#x3D;&quot;userDao&quot; class&#x3D;&quot;org.example.UserDao&quot;&#x2F;&gt;\n        &lt;bean id&#x3D;&quot;userService&quot; class&#x3D;&quot;org.example.UserService&quot;&gt;\n            &lt;property name&#x3D;&quot;userDao&quot; ref&#x3D;&quot;userDao&quot;&#x2F;&gt;\n        &lt;&#x2F;bean&gt;\n&lt;&#x2F;beans&gt;</code></pre>\n<ul>\n<li>配置文件的解释<ul>\n<li>spring-config.xml为Spring全局配置文件，放置于项目根目录下。配置文件中<code>&lt;bean id=&quot;userDao&quot; class=&quot;org.example.UserDao&quot;/&gt;</code>就是告诉Spring要new一个这个对象，交由Spring管理，<code>id</code>在xml中唯一，<code>class</code>是对应的类路径。</li>\n<li>第二个bean作用与上面<code>userDao</code>的配置一样，但是里面的<code>property</code>是告诉Spring，要使用setter方式将<code>ref</code>引用的<code>id</code>为<code>userDao</code>的创建好的bean通过<code>UserService</code>类中叫做<code>setUserDao</code>的方法注入到<code>UserService</code>中的实例未赋值的变量<code>userDao</code>中。即若使用setter方法注入，我们就必须为成员变量设置一个set方法，<code>property</code>中的<code>name</code>是这个方法名去掉<code>set</code>后首字母小写值，假如一个方法名为<code>setQidai</code>，若要使用<code>name</code>，则那么<code>name</code>值为<code>qidai</code>，就是这样一种约定，如上java代码中，<code>UserService</code>中有一个<code>setUserDao</code>方法，则此处的<code>name</code>就为<code>userDao</code>，<code>ref</code>就是寻找<code>xml</code>中<code>id</code>为<code>userDao</code>的<code>bean</code>，然后通过编写的setter方法进行赋值。</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"/img/spring/powernode-spring6/1-1.png\"></p>\n<ul>\n<li>看到输出，那么究竟发生了什么？<ul>\n<li>当测试程序运行了   <code> ApplicationContext context = new ClassPathXmlApplicationContext(&quot;spring-config.xml&quot;);</code>则Spring就已经将UserDao和UserService初始化，并输出了<code>。</code>，此时我们知道了Spring bean的创建是通过无参构造进行的。若Bean中没有无参构造则报错。原理是利用了反射。</li>\n<li>创建好的对象交由Spring管理，Spring放入了一个Map中进行存储，当使用context.getBean(…)时，参数其实是Map中的key。</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"源码跟踪：Spring初始Bean的过程\"><a href=\"#源码跟踪：Spring初始Bean的过程\" class=\"headerlink\" title=\"源码跟踪：Spring初始Bean的过程\"></a>源码跟踪：Spring初始Bean的过程</h2>","abstracts":"来自教学视频学习笔记。","text":"来自教学视频学习笔记。","link":"","photos":[],"count_time":{"symbolsCount":"5.7k","symbolsTime":"5 mins."},"categories":[{"name":"Spring6","slug":"Spring6","count":1,"path":"api/categories/Spring6.json"}],"tags":[{"name":"Spring6","slug":"Spring6","count":1,"path":"api/tags/Spring6.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#OCP%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99\"><span class=\"toc-text\">OCP开闭原则</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#DIP%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE\"><span class=\"toc-text\">DIP依赖倒置</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%B8%A4%E4%B8%AA%E9%97%AE%E9%A2%98\"><span class=\"toc-text\">两个问题</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%ACIoC\"><span class=\"toc-text\">控制反转IoC</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#Spring%E7%BB%93%E6%9E%84\"><span class=\"toc-text\">Spring结构</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%A1%88%E4%BE%8B%E7%A8%8B%E5%BA%8F%EF%BC%9Asetter%E6%B3%A8%E5%85%A5\"><span class=\"toc-text\">案例程序：setter注入</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%BA%90%E7%A0%81%E8%B7%9F%E8%B8%AA%EF%BC%9ASpring%E5%88%9D%E5%A7%8BBean%E7%9A%84%E8%BF%87%E7%A8%8B\"><span class=\"toc-text\">源码跟踪：Spring初始Bean的过程</span></a></li></ol></li></ol>","author":{"name":"Qidai","slug":"blog-author","avatar":"/img/v2-b98d05a15e22949b1a1c70d453fb71ed_720w.jpg","link":"/","description":"吃喝，死宅，折腾","socials":{"github":"https://github.com/ziqiang-wang-chn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/291152218"},"mail":{"icon":"/svg/mail.svg","link":"mailto:ziqiang_wang_chn@163.com"},"rss":{"icon":"/svg/RSS.svg","link":"https://ohbug.cn/atom.xml"}}}},"mapped":true,"prev_post":{"title":"MySQL必知必会 {一}","uid":"8d49f1dff289c8a88e72afa0d38a120a","slug":"mysql/mysqlmustknow","date":"2023-01-16T13:08:37.000Z","updated":"2023-01-24T12:50:37.286Z","comments":true,"path":"api/articles/mysql/mysqlmustknow.json","keywords":null,"cover":"/img/mysql/mysqlmust.jpg","text":"以《MySQL必知必会》为纲，学习MySQL的常用操作的学习笔记。文中也会参考极客时间课程《MySQL实战45讲》。","link":"","photos":[],"count_time":{"symbolsCount":"10k","symbolsTime":"9 mins."},"categories":[{"name":"MySQL基础","slug":"MySQL基础","count":1,"path":"api/categories/MySQL基础.json"}],"tags":[{"name":"MySQL","slug":"MySQL","count":1,"path":"api/tags/MySQL.json"},{"name":"《MySQL必知必会》","slug":"《MySQL必知必会》","count":1,"path":"api/tags/《MySQL必知必会》.json"}],"author":{"name":"Qidai","slug":"blog-author","avatar":"/img/v2-b98d05a15e22949b1a1c70d453fb71ed_720w.jpg","link":"/","description":"吃喝，死宅，折腾","socials":{"github":"https://github.com/ziqiang-wang-chn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/291152218"},"mail":{"icon":"/svg/mail.svg","link":"mailto:ziqiang_wang_chn@163.com"},"rss":{"icon":"/svg/RSS.svg","link":"https://ohbug.cn/atom.xml"}}}}},"next_post":{"title":"Java复习篇：继承，接口","uid":"a24485c2a08f5a5922225dff3c3d2ee2","slug":"java/basic/basicjava2","date":"2023-01-11T01:47:37.000Z","updated":"2023-02-02T10:06:34.937Z","comments":true,"path":"api/articles/java/basic/basicjava2.json","keywords":null,"cover":"/img/java/basicjava.jpg","text":"内容来自于自己的拓展总结，对知识点进行总结，不过多涉及基础语法，例如定义循环等。文中部分的引用的来源见文章开头。","link":"","photos":[],"count_time":{"symbolsCount":"4.5k","symbolsTime":"4 mins."},"categories":[{"name":"java基础","slug":"java基础","count":6,"path":"api/categories/java基础.json"}],"tags":[{"name":"java","slug":"java","count":6,"path":"api/tags/java.json"}],"author":{"name":"Qidai","slug":"blog-author","avatar":"/img/v2-b98d05a15e22949b1a1c70d453fb71ed_720w.jpg","link":"/","description":"吃喝，死宅，折腾","socials":{"github":"https://github.com/ziqiang-wang-chn","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://space.bilibili.com/291152218"},"mail":{"icon":"/svg/mail.svg","link":"mailto:ziqiang_wang_chn@163.com"},"rss":{"icon":"/svg/RSS.svg","link":"https://ohbug.cn/atom.xml"}}}}}}